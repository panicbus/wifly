<!DOCTYPE html>
<html>
<head>
  <title>Wifly</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.css" />
  <script src="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.js"></script>
  <link href='http://fonts.googleapis.com/css?family=Quicksand' rel='stylesheet' type='text/css'>

</head>
<body>
  <!-- <div id="map"> -->
      <div id="main_container">
        <%= flash[:notice] %>
        <%= yield %>

      </div>
  </div>
    <script type="text/javascript">
      var map = L.map('map').setView([48.892, 2.40], 13);

       <% if @lat.present? && @lng.present? %>
        var marker = L.marker([<%= @location.latitude %>, <%= @location.longitude %>]).addTo(map);

        marker.openPopup('click').bindPopup("<b><%= @searched_airports %></b><br>").openPopup();
      <% end %>

       L.tileLayer('http://{s}.tile.cloudmade.com/3f67482caa0a497e8193801abf8ed7cd/997/256/{z}/{x}/{y}.png', {
          attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
        maxZoom: 15, minZoom: 5
      }).addTo(map);

      // Calculate the offset
      var offset = map.getSize().x*0.14;
      // Then move the map
      map.panBy(new L.Point(-offset, 300), {animate: false});


      // var popup = L.popup()
      //   .setLatLng([<%= @lat %>, <%= @lng %>])
      //   .setContent("#{@searched_airports} poppity poppity.")
      //   .openOn(map);

    </script>



</body>
</html>
